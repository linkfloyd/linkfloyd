{% extends "base.html" %}{% load i18n gravatar channel_tags %}

{% block extra_head %}
<script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.js"></script>
{% if highlight %}<script type="text/javascript" src="{{STATIC_URL}}/js/libs/jquery.color.js"></script>
{% endif %}
{% endblock extra_head %}

{% block content %}
<script id="submitReportFormTemplate" type="text/x-jquery-tmpl">
    <form id="submitReportForm" style="display: none" action="">
        <div class="fieldWrapper">
            <label for="id_reason"><ul class="errorlist" style="display:none"><li>This field is required.</li></ul>Reason: <span class="desc">why are you reporting this?</span></label>
            <select name="reason" id="id_reason">
                <option value="" selected="selected">Please select a reason</option>
                <option value="hatespeech">Contains hate Speech</option>
                <option value="wrong_channel">Channel is not appropriate</option>
                <option value="wrong_rating">Rating is not appropriate</option>
                <option value="wrong_language">Language is not appropriate</option>
                <option value="other">Other</option>
            </select>
        </div>
        <div class="fieldWrapper">
            <label for="id_note">Note: <span class="desc">do you have note for admins?</span></label>
            <input id="id_note" type="input" name="note" maxlength="255" />
        </div>
        <input id="id_link" type="hidden" name="link" value="${link_id}" />
        <div class="fieldWrapper">
            <input type="submit" class="small right" value="submit" />
        </div>
    </form>
</script>

<div class="two-column">
    <div class="panel">
        {% if user.is_authenticated %}
            <div class="channels section">
                <h2 class="header">{% trans "Subscripted Channels" %}</h2>
                <ul class="channels">
                    <li class="butonized"><a href="/channels/create/">Create a Channel</a></li>
                    {% for subscription in user.subscription_set.all %}
                        <li><a href="{{subscription.channel.get_absolute_url}}">{{subscription.channel}}</a></li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
        {% if channel %}
         <div class="followers section">
            <h2 class="header">{% trans "Subscribers" %} ({{channel.subscription_set.all.count}})</h2>
            <div class="followers">
                {% for subscription in channel.subscription_set.all %}
                <a href="#" id="{{subscription.user.username}}">
                    <img src="{% gravatar_for_user subscription.user 30 %}">
                </a>
                {% endfor %}
            </div>
        </div>
       {% endif %}
    </div>
    <div class="content section">
        <h2 class="header">{{listing_title}}
            <span class="right">
                {% if channel %}
                    {% if user|is_following:channel %}
                        <a href="#" class="unsubscribe" x:channel_id="{{channel.id}}">Unsubscribe</a>
                    {% else %}
                        <a href="#" class="subscribe" x:channel_id="{{channel.id}}">Subscribe</a>
                    {% endif %}
                {% endif %}
            </span></h2>
        <div class="body">
            {%  if channel %}
                <a class="butonized" style="display: block" href="/links/submit/?channel={{ channel.slug }}">Add a Link to {{ channel }}</a>
            {% endif %}
            {% for link in links %}
                {% include "links/link_as_list_item.html" %}
            {% empty %}
                <p class="warning">
                    {% trans "No links found." %}
                </p>
            {% endfor %}
                <div class="pagination">
                    <span class="page_links">
                        {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">previous</a>{% endif %}
                        {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">next</a>{% endif %}
                    </span>
                </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="{{STATIC_PREFIX}}js/links.js"></script>
{% if highlight %}
    <script type="text/javascript">
        $("div.link#"+{{highlight}}).animate({
            backgroundColor: 'rgba(0, 0, 0, 0)'}, 6000);
    </script>
{% endif %}
<script type="text/javascript">
    var addthis_config =
        { services_compact: 'email, gmail, facebook, twitter',
          services_exclude: 'formspring',
          ui_click: true }

    var addthis_localize =
        { share_caption: "{% trans 'Share' %}",
        email: "{% trans 'E-posta' %}" }
</script>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4ec6bf7a4c4877e7"></script>
{% endblock content %}
